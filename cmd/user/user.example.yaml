host:
  eth_ip: ${HOST_ETH_IP:-}
  wan_ip: ${HOST_WAN_IP:-}
  mac: ${HOST_MAC:-}
  dns: ${HOST_DNS:-}
  net_mask: ${HOST_NET_MASK:-}
sms:
  providers:
    - vendor: 1 # 1-阿里云 4-火山云
      access_key: ${USER_SMS_ALIYUN_ACCOUNT1_ACCESS_KEY:-}
      secret_key: ${USER_SMS_ALIYUN_ACCOUNT1_SECRET_KEY:-}
      account: "ACCOUNT1"
      limit: 5000 # 阿里云默认限制5000/s
mail:
  - vendor: 2 # 1-自有邮箱 2-阿里云
    account: "ACCOUNT1"
    limit_duration: "180s"
    limit_max: "5000"
    max_connections: 1000
    smtp:
      host: ${USER_SMTP_ALIYUN_ACCOUNT1_HOST:-}
      port: ${USER_SMTP_ALIYUN_ACCOUNT1_PORT:-}
      user_name: ${USER_SMTP_ALIYUN_ACCOUNT1_USER_NAME:-}
      password: ${USER_SMTP_ALIYUN_ACCOUNT1_PASSWORD:-}
      skip_tls: false
      timeout: "30s"
captcha:
  providers:
    - sender: 1 # 短信
      prefix: "user:cap:sms"
      err_prefix: "user:cap:sms:err"
      keeping: "300s"
      case_sensitive: false
      err_try_limit: 3
      limits:
        - duration: "60s"
          limit: 1
          tag: "60s1"
        - duration: "300s"
          limit: 3
          tag: "300s3"
        - duration: "24h"
          limit: 10
          tag: "24h10"
    - sender: 2 # 邮件
      prefix: "user:cap:mail"
      err_prefix: "user:cap:mail:err"
      keeping: "600s"
      case_sensitive: false
      err_try_limit: 3
      limits:
        - duration: "60s"
          limit: 1
          tag: "60s1"
        - duration: "600s"
          limit: 5
          tag: "600s5"
        - duration: "24h"
          limit: 20
          tag: "24h20"
global_id:
  mode: 1 # 单机模式
  start_time: "2025-09-12T00:00:00+08:00"
short_id:
  alphabet: "abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ0123456789"
  min_length: 8
  block_list:
    - "l"
    - "1"
    - "o"
    - "O"
    - "0"
wechat:
  credentials:
    - appid: ${USER_WECHAT_CREDENTIALS_APPID1:-}
      secret: ${USER_WECHAT_CREDENTIALS_SECRET1:-}
db:
  db_type: 2 # 1-mysql 2-postgres
  log:
    slow_threshold: 30 #单位ms
    out: 1 # 1-stdout 2-stderr 3-file
    colorful: false
    ignore_record_not_found_err: true
    parameterized_queries: false
    level: 2 # 1-silent 2-error 3-warn 4-info
    rotation:
      log_file: "/log/db.log"
      max_size: 500 # 单位M
      max_age: 7 # 单位天
      max_backups: 10 # 单位个
      compress: false
      local_time: true
  #  conn:
  #    conn_max_life_time: ""
  #    max_idle_time: ""
  #    max_idle_connes: ""
  #    max_open_connes: ""
  mysql:
    host: ${USER_DB_MYSQL_HOST:-}
    port: ${USER_DB_MYSQL_PORT:-}
    user: ${USER_DB_MYSQL_USER:-}
    password: ${USER_DB_MYSQL_PASSWORD:-}
    db_name: ${USER_DB_MYSQL_DB_NAME:-}
    charset: ${USER_DB_MYSQL_CHARSET:-utf8mb4}
    conn_timeout: 60 # 单位s
    read_timeout: 30 # 单位s
  postgres:
    host: ${USER_DB_POSTGRES_HOST:-}
    port: ${USER_DB_POSTGRES_PORT:-}
    user: ${USER_DB_POSTGRES_USER:-}
    password: ${USER_DB_POSTGRES_PASSWORD:-}
    db_name: ${USER_DB_POSTGRES_DB_NAME:-}
    time_zone: ${USER_DB_POSTGRES_TIME_ZONE:-Asia/Shanghai}
    schema: ${USER_DB_POSTGRES_SCHEMA:-public}
    ssl_mode: false
redis:
  addr: ${USER_REDIS_ADDR:-}
  user: ${USER_REDIS_USER:-}
  password: ${USER_REDIS_PASSWORD:-}
  db: ${USER_REDIS_DB:-1}
  protocol: 3
  client_name: ${USER_SERVICE_NAME:-user}
distributed_lock:
  ttl: "10s"
  prefix: "user:lock"
log_config:
  mode: 1 # 1-dev 2-prod
  format: 2 #1-json 2-console
  level: 1 # 1-debug 2-info 3-warn 4-error 5-panic 6-fatal
  report_caller: true
  caller_skip: 1
  add_stack_trace_level: 4
  service_name: ${USER_SERVICE_NAME:-user}
  ctx_log_id_key: "log_id"
  log_id_key: "log_id"
  record_all_errors: true
  keys:
    name_key: "srv"
    level_key: "level"
    message_key: "msg"
    time_key: "time"
    caller_key: "caller"
    stack_trace_key: "trace"
    function_key: "fn"
#  outputs:
#    - output: 1 # 1-stdout 2-stderr 3-file
#      levels:
#        - 1
#        - 2
#        - 3
#        - 4
#        - 5
#        - 6
#      log_file:
#        log_file: "/log/base.log"
#        max_size: 500 # 单位M
#        max_age: 7 # 单位天
#        max_backups: 10 # 单位个
#        compress: false
#        local_time: true
user:
  listen_addr: "0.0.0.0"
  listen_port: 8888
  password_hasher_cost: ${USER_PASSWORD_HASHER_COST:-10}
  enable_auth:
    - 1 # 用户编号密码登录
    - 2 # 邮箱密码登录
    - 3 # 手机密码登录
    - 4 # 手机验证码验证登录
    - 5 # 邮箱验证码验证登录
    - 6 # 微信授权码验证登录
  auth_limiter:
    prefix: "user:limit:auth"
    err_prefix: "user:limit:auth:err"
    sign_in_rule:
      duration: "300s"
      limit: 3
      tag: "300s3"
    refresh_rule:
      duration: "600s"
      limit: 10
      tag: "600s10"
    sign_err_rules:
      - duration: "60s"
        limit: 3
        tag: "60s3"
      - duration: "300s"
        limit: 5
        tag: "300s10"
      - duration: "24h"
        limit: 10
        tag: "24h10"
  jwt:
    issuer: ${USER_SERVICE_NAME:-base}
    secret_key: ${USER_JWT_SECRET_KEY:-}
    sign_method: ${USER_JWT_SIGN_METHOD:-HS256}
    max_active_sessions: 10
    access_ttl: ${USER_JWT_ACCESS_TTL:-15m}
    refresh_ttl: ${USER_JWT_REFRESH_TTL:168h}
  two_step_verifier:
    prefix: "user:cap:two"
    keeping: "600s"
  cache:
  session_block_list:
    prefix: "user:bkl:sess"





